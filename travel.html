<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æ—…è¡Œæœƒè©±</title>
<link rel="stylesheet" href="styles.css" />
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ffffff">
<link rel="apple-touch-icon" href="icons/icon-512.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<script>
  if ("serviceWorker" in navigator) { window.addEventListener("load", () => { navigator.serviceWorker.register("/sw.js"); }); }
</script>
</head>
<body>

<header class="appbar">
  <div class="wrap">
    <h1>æ—…è¡Œæœƒè©±</h1>
    <div class="badge">x0.75</div>
  </div>
</header>

<main class="wrap">
  <div class="controls">
    <label>è‹±æ–‡è²éŸ³
      <select id="voiceEn" class="select"></select>
    </label>
    <label class="control">å¡é€šæ¨¡å¼ <span id="mickey" class="icon-mickey" title="Cartoon"></span></label>
  </div>

  <section class="section">
    <div class="legend">ğŸ½ï¸ é¤å»³ / é»é¤</div>
    <div class="list" id="listR"></div>
  </section>

  <section class="section">
    <div class="legend">ğŸ›ï¸ è³¼ç‰© / é¡è‰²ãƒ»å°ºå¯¸ãƒ»è©¦ç©¿</div>
    <div class="list" id="listS"></div>
  </section>

  <section class="section">
    <div class="legend">ğŸ§­ å•è·¯</div>
    <div class="list" id="listN"></div>
  </section>
</main>
<nav class="tabbar"><div class="in">
<a class='' href='index.html'><svg width='22' height='22' viewBox='0 0 24 24' fill='none' stroke='#9aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M3 10l9-7 9 7v7a2 2 0 0 1-2 2h-3m-8 0H6a2 2 0 0 1-2-2v-7'/></svg><span>ç™¼éŸ³ç·´ç¿’</span></a>
<a class='active' href='travel.html'><svg width='22' height='22' viewBox='0 0 24 24' fill='none' stroke='#9aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M21 16v-5a2 2 0 0 0-2-2h-5l-3-3-3 3H3a2 2 0 0 0-2 2v5'/></svg><span>æ—…è¡Œæœƒè©±</span></a>
<a class='' href='translate.html'><svg width='22' height='22' viewBox='0 0 24 24' fill='none' stroke='#9aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M4 5h7M7.5 5c0 6 5 9 9 9m0 0l-3-3m3 3l3-3'/></svg><span>å¯¦æ™‚ç¿»è­¯</span></a>
<a class='' href='history.html'><svg width='22' height='22' viewBox='0 0 24 24' fill='none' stroke='#9aa' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 8v5l3 3M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0'/></svg><span>æ­·å²ç´€éŒ„</span></a>
</div></nav>
<footer>Web Speech APIï¼ˆko-KR / en-*ï¼‰ã€‚</footer>

<script>
const EN = ["Daniel","Moira","Samantha","Tessa"];
function whitelisted(){
  const all=speechSynthesis.getVoices();
  const ok=[]; EN.forEach(name=>{ const v=all.find(x=>x.name===name); if(v) ok.push(v); });
  return ok;
}
function populate(){
  const sel=document.getElementById('voiceEn');
  sel.innerHTML="";
  const list=whitelisted();
  if(!list.length){ sel.innerHTML="<option>è¼‰å…¥ä¸­â€¦</option>"; return; }
  list.forEach((v,i)=>{ const o=document.createElement('option'); o.value=v.name; o.textContent=v.name; sel.appendChild(o); if(i===0) sel.value=v.name; });
  const saved=localStorage.getItem('voiceEnName'); if(saved && list.some(v=>v.name===saved)) sel.value=saved;
  sel.addEventListener('change',()=>localStorage.setItem('voiceEnName', sel.value));
}
function rate(){ return 0.75; }
let vKo=null, vEn=null;
function speakKO(t){
  const u=new SpeechSynthesisUtterance(t);
  vKo = vKo || speechSynthesis.getVoices().find(v=>/ko/i.test(v.lang||"")); if(vKo) u.voice=vKo;
  u.lang='ko-KR'; u.rate=rate(); speechSynthesis.speak(u);
}
function speakEN(t){
  const sel=document.getElementById('voiceEn');
  const voices=speechSynthesis.getVoices();
  vEn = voices.find(v=>v.name===sel.value) || whitelisted()[0] || null;
  const u=new SpeechSynthesisUtterance(t); if(vEn) u.voice=vEn;
  u.lang = (vEn && vEn.lang) ? vEn.lang : 'en-US';
  u.rate=rate();
  if(document.getElementById('mickey').classList.contains('on')) u.pitch=1.6;
  speechSynthesis.speak(u);
}
document.getElementById('mickey').addEventListener('click',e=>e.target.classList.toggle('on'));

const DATA={ 
  R:[
    ["ì¶”ì²œ ë©”ë‰´ê°€ ë­ì˜ˆìš”?","What do you recommend?","æœ‰æ¨è–¦çš„é¤é»å—ï¼Ÿ"],
    ["ëœ ë§¤ìš´ ê±¸ë¡œ í•´ ì£¼ì„¸ìš”.","Please make it less spicy.","å¯ä»¥åšä¸é‚£éº¼è¾£å—ï¼Ÿ"],
    ["ê³„ì‚°ì„œ ë”°ë¡œ í•´ ì£¼ì„¸ìš”.","Could we split the bill?","è«‹åˆ†é–‹çµå¸³ã€‚"]
  ],
  S:[
    ["ì´ê±° ë‹¤ë¥¸ ìƒ‰ ìˆì–´ìš”?","Do you have this in other colors?","é€™å€‹æœ‰åˆ¥çš„é¡è‰²å—ï¼Ÿ"],
    ["ì´ê±° S, M, L ì‚¬ì´ì¦ˆ ìˆì–´ìš”?","Do you have this in S, M, or L?","é€™å€‹æœ‰æ²’æœ‰ Sã€Mã€L ä¹‹é¡çš„å°ºå¯¸ï¼Ÿ"],
    ["ì…ì–´ ë´ë„ ë¼ìš”?","May I try it on?","å¯ä»¥è©¦ç©¿å—ï¼Ÿ"],
    ["ì´ê±° ì–¼ë§ˆì˜ˆìš”? í• ì¸ë¼ìš”?","How much is this? Any discount?","é€™å€‹å¤šå°‘éŒ¢ï¼Ÿæœ‰æŠ˜æ‰£å—ï¼Ÿ"]
  ],
  N:[
    ["ì´ ì‚¬ì§„ì²˜ëŸ¼ ë³´ì´ëŠ” ê³³ì€ ì–´ë””ì˜ˆìš”?","Where is this place in the photo?","é€™å¼µç…§ç‰‡è£¡çš„åœ°æ–¹åœ¨å“ªè£¡ï¼Ÿ"],
    ["ì—¬ê¸°ë¡œ ê°€ë ¤ë©´ ì–´ë–»ê²Œ ê°€ìš”?","How do I get here?","è¦åˆ°é€™è£¡æ€éº¼èµ°ï¼Ÿ"],
    ["ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°€ì„¸ìš”. ì™¼ìª½ìœ¼ë¡œ ê°€ì„¸ìš”. ì­‰ ê°€ì„¸ìš”.","Go right. Go left. Go straight.","å¾€å³èµ°ï¼å¾€å·¦èµ°ï¼ç›´èµ°ã€‚"]
  ]
};
function card(kr,en,zh){
  const div=document.createElement('div'); div.className='item';
  div.innerHTML=`<div class='krl'>${kr}</div><div class='eng'>${en}</div><div class='zh'>${zh}</div>
  <div class='ops'>
    <button class='btn' data-ko='${kr}'>éŸ“</button>
    <button class='btn' data-en='${en}'>è‹±</button>
  </div>`;
  return div;
}
function render(){
  const lR=document.getElementById('listR'), lS=document.getElementById('listS'), lN=document.getElementById('listN');
  DATA.R.forEach(([k,e,z])=>lR.appendChild(card(k,e,z)));
  DATA.S.forEach(([k,e,z])=>lS.appendChild(card(k,e,z)));
  DATA.N.forEach(([k,e,z])=>lN.appendChild(card(k,e,z)));
}
document.addEventListener('click',e=>{
  const k=e.target.getAttribute('data-ko'); if(k){ speakKO(k); return; }
  const n=e.target.getAttribute('data-en'); if(n){ speakEN(n); return; }
});
window.speechSynthesis.onvoiceschanged = ()=>populate();
populate(); render();
</script>
</body>
</html>
